<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <assignments>
        <name>Assign_Actual_End_0</name>
        <label>Assign Actual End</label>
        <locationX>1140</locationX>
        <locationY>1451</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.ActualEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Status_to_SA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Actual_End_from_User</name>
        <label>Assign Actual End from User</label>
        <locationX>1050</locationX>
        <locationY>1229</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.ActualEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varNewEndTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Status_to_SA</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Actual_Start</name>
        <label>Assign Actual Start</label>
        <locationX>354</locationX>
        <locationY>999</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.ActualStartTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ServiceAppointment.ActualEndTime</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Get_Timesheet_data_for_the_Assigned_Resource</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_SA_data2</name>
        <label>Assign SA data</label>
        <locationX>1525</locationX>
        <locationY>663</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Mileage__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Mileage_Input</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Trailer__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Trailer_Input</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>SA_status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_SA_data2_0</name>
        <label>Assign SA data</label>
        <locationX>477</locationX>
        <locationY>217</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Current_status_specific_behavior</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_Dispatched</name>
        <label>Assign status Dispatched</label>
        <locationX>686</locationX>
        <locationY>688</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_Dispatched</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_InProgress</name>
        <label>Assign status In Progress</label>
        <locationX>579</locationX>
        <locationY>684</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_InProgress</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_None</name>
        <label>Assign status None</label>
        <locationX>259</locationX>
        <locationY>682</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_None</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_Paused</name>
        <label>Assign status Paused</label>
        <locationX>127</locationX>
        <locationY>680</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_Paused</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_Scheduled</name>
        <label>Assign status Scheduled</label>
        <locationX>369</locationX>
        <locationY>683</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_Scheduled</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_status_Travel</name>
        <label>Assign status Travel</label>
        <locationX>486</locationX>
        <locationY>683</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Select_Status_Travel</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_changed_Status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Travel_Start</name>
        <label>Assign Travel Start</label>
        <locationX>479</locationX>
        <locationY>1102</locationY>
        <assignmentItems>
            <assignToReference>ServiceAppointment.LUM_Travel_Start__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_WO_data</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_WO_status</name>
        <label>Assign WO status</label>
        <locationX>586</locationX>
        <locationY>1229</locationY>
        <assignmentItems>
            <assignToReference>WorkOrder.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>In Progress</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_WO_status</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_new_end_time</name>
        <label>Set new end time</label>
        <locationX>1290</locationX>
        <locationY>1016</locationY>
        <assignmentItems>
            <assignToReference>varNewEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>End_time_can_be_adjusted_here</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Installers_comments__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Installer_s_comments</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_if_date_was_given</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_new_end_time_0</name>
        <label>Set new end time</label>
        <locationX>1395</locationX>
        <locationY>1160</locationY>
        <assignmentItems>
            <assignToReference>varNewEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>End_time_can_be_adjusted_here_0</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ServiceAppointment.Installers_comments__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Installer_s_comments2</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_if_date_was_given</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Canceled</name>
        <choiceText>Canceled</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Canceled</stringValue>
        </value>
    </choices>
    <choices>
        <name>CannotComplete</name>
        <choiceText>Cannot Complete</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Cannot Complete</stringValue>
        </value>
    </choices>
    <choices>
        <name>Completed</name>
        <choiceText>Completed</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Completed</stringValue>
        </value>
    </choices>
    <choices>
        <name>Dispatched</name>
        <choiceText>Dispatched</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Dispatched</stringValue>
        </value>
    </choices>
    <choices>
        <name>InProgress</name>
        <choiceText>In Progress</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>In Progress</stringValue>
        </value>
    </choices>
    <choices>
        <name>Paused</name>
        <choiceText>Paused</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Paused</stringValue>
        </value>
    </choices>
    <choices>
        <name>Scheduled</name>
        <choiceText>Scheduled</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Scheduled</stringValue>
        </value>
    </choices>
    <choices>
        <name>Travel</name>
        <choiceText>Travel</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Travel</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Check_if_date_was_given</name>
        <label>Check if date was given</label>
        <locationX>1131</locationX>
        <locationY>1119</locationY>
        <defaultConnector>
            <targetReference>Assign_Actual_End_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Date empty</defaultConnectorLabel>
        <rules>
            <name>Date_given</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varNewEndTime</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Actual_End_from_User</targetReference>
            </connector>
            <label>Date given</label>
        </rules>
    </decisions>
    <decisions>
        <name>Current_status_specific_behavior</name>
        <label>Current status specific behavior</label>
        <locationX>469</locationX>
        <locationY>361</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Status_Scheduled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Scheduled</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status_0</targetReference>
            </connector>
            <label>Scheduled</label>
        </rules>
        <rules>
            <name>Status_None</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>None</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status</targetReference>
            </connector>
            <label>None</label>
        </rules>
        <rules>
            <name>Status_Travel</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Travel</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status_2</targetReference>
            </connector>
            <label>Travel</label>
        </rules>
        <rules>
            <name>Status_In_Progress</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>In Progress</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status_3</targetReference>
            </connector>
            <label>In Progress</label>
        </rules>
        <rules>
            <name>Status_Dispatched</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Dispatched</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SA_must_have_AR</targetReference>
            </connector>
            <label>Dispatched</label>
        </rules>
        <rules>
            <name>Status_Completed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>No_status_transition_available</targetReference>
            </connector>
            <label>Completed</label>
        </rules>
        <rules>
            <name>Status_Cannot_Complete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cannot Complete</stringValue>
                </rightValue>
            </conditions>
            <label>Cannot Complete</label>
        </rules>
        <rules>
            <name>Status_Canceled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Canceled</stringValue>
                </rightValue>
            </conditions>
            <label>Canceled</label>
        </rules>
        <rules>
            <name>Paused3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Paused</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status_4</targetReference>
            </connector>
            <label>Paused</label>
        </rules>
    </decisions>
    <decisions>
        <name>Mileage_to_be_input</name>
        <label>Mileage to be input</label>
        <locationX>1121</locationX>
        <locationY>671</locationY>
        <defaultConnector>
            <targetReference>SA_status</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Mileage_needs_to_be_entered</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Enter_Mileage_Screen</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>SA_must_have_AR</name>
        <label>SA must have AR</label>
        <locationX>683</locationX>
        <locationY>365</locationY>
        <defaultConnector>
            <targetReference>No_Assigned_Resource</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Does not have AR</defaultConnectorLabel>
        <rules>
            <name>Has_AR</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.LUM_Assigned_Service_Resource__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Status_1</targetReference>
            </connector>
            <label>Has AR</label>
        </rules>
    </decisions>
    <decisions>
        <name>SA_status</name>
        <label>SA status</label>
        <locationX>1517</locationX>
        <locationY>880</locationY>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Cannot_Complete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cannot Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Closing_of_Service_Appointment_0</targetReference>
            </connector>
            <label>Cannot Complete</label>
        </rules>
        <rules>
            <name>Completed1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Closing_of_Service_Appointment</targetReference>
            </connector>
            <label>Completed</label>
        </rules>
        <rules>
            <name>Paused1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Paused</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Pausing_of_Service_Appointment</targetReference>
            </connector>
            <label>Paused</label>
        </rules>
    </decisions>
    <decisions>
        <name>Time_Sheet_status</name>
        <label>Time Sheet status</label>
        <locationX>233</locationX>
        <locationY>1427</locationY>
        <defaultConnector>
            <targetReference>Time_Sheet_notification</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>This TS has not been approved or sent for approval</defaultConnectorLabel>
        <rules>
            <name>This_TS_is_ok</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Timesheet.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Submitted</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Timesheet.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approved</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Are_there_TS_which_are_not_sent_for_approval</targetReference>
            </connector>
            <label>This TS is ok</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_is_changed_Status</name>
        <label>What is changed Status?</label>
        <locationX>667</locationX>
        <locationY>893</locationY>
        <defaultConnector>
            <targetReference>Update_Status_to_SA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other Statuses</defaultConnectorLabel>
        <rules>
            <name>Status_is_Completed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Was_traveling_done</targetReference>
            </connector>
            <label>Status is Completed</label>
        </rules>
        <rules>
            <name>Status_is_Travel</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Travel</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Travel_Start</targetReference>
            </connector>
            <label>Status is Travel</label>
        </rules>
        <rules>
            <name>Status_is_In_Progress</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>In Progress</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Actual_Start</targetReference>
            </connector>
            <label>Status is In Progress</label>
        </rules>
        <rules>
            <name>Status_is_Cannot_Complete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cannot Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Was_traveling_done</targetReference>
            </connector>
            <label>Status is Cannot Complete</label>
        </rules>
        <rules>
            <name>Status_is_Paused</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ServiceAppointment.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Paused</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Was_traveling_done</targetReference>
            </connector>
            <label>Status is Paused</label>
        </rules>
    </decisions>
    <description>Picks the status from the SA and allows user to transition the status.

21.12.2023: Support for adding Installer&apos;s Comments.
10.11.2023: Change to default settings for mileage input and trailer used input.
30.10.2023: Removed CDL adding logic from here. It is now only running 5mins after in &quot;SA - Copy Pictures to Asset&quot; flow. Removed weird remnants of TSE update. Fixed capturing new End Time for SA in Cannot Complete status change.
31.3.2023: Fix for reporting mileage correctly.
18.1.2023: Added logic for handling SA pausing.
21.11.2022: Cannot Complete status change logic changes.
18.11.2022: Asset image logic change.
14.11.2022: Content Document logic added here for the Installation Image handling.
21.10.2022: Mileage logic added
17.11.2022: Update to verify asset image upload processing via APEX Trigger
02.12.2023: Save Active Version as R2
08.02.2024: Updated Version with Installers Comments on Service Appointment</description>
    <dynamicChoiceSets>
        <description>Service Appointment status values.</description>
        <name>Statusvalues</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Status</picklistField>
        <picklistObject>ServiceAppointment</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>Date_Today</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate}</expression>
    </formulas>
    <formulas>
        <name>Date_Week_Ago</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate} - 7</expression>
    </formulas>
    <interviewLabel>Mobile - change SA status {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Mobile - change SA status R2.2</label>
    <loops>
        <name>Are_there_TS_which_are_not_sent_for_approval</name>
        <label>Are there TS which are not sent for approval</label>
        <locationX>241</locationX>
        <locationY>1228</locationY>
        <assignNextValueToReference>Timesheet</assignNextValueToReference>
        <collectionReference>Timesheets</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Time_Sheet_status</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_WO_data</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>FieldServiceMobile</processType>
    <recordLookups>
        <description>Reads SA record fields, so that they can be used.</description>
        <name>Get_SA_data</name>
        <label>Get SA data</label>
        <locationX>373</locationX>
        <locationY>217</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_SA_data2_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Id</elementReference>
            </value>
        </filters>
        <object>ServiceAppointment</object>
        <outputReference>ServiceAppointment</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Status</queriedFields>
        <queriedFields>LUM_Assigned_Service_Resource__c</queriedFields>
        <queriedFields>LUM_Parent_Work_Order__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Timesheet_data_for_the_Assigned_Resource</name>
        <label>Get Timesheet data for the Assigned Resource</label>
        <locationX>241</locationX>
        <locationY>999</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Are_there_TS_which_are_not_sent_for_approval</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ServiceResourceId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>ServiceAppointment.LUM_Assigned_Service_Resource__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>CreatedDate</field>
            <operator>GreaterThan</operator>
            <value>
                <elementReference>Date_Week_Ago</elementReference>
            </value>
        </filters>
        <filters>
            <field>CreatedDate</field>
            <operator>LessThan</operator>
            <value>
                <elementReference>Date_Today</elementReference>
            </value>
        </filters>
        <object>TimeSheet</object>
        <outputReference>Timesheets</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>ServiceResourceId</queriedFields>
        <queriedFields>Status</queriedFields>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_WO_data</name>
        <label>Get WO data</label>
        <locationX>479</locationX>
        <locationY>1229</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_WO_status</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>ServiceAppointment.LUM_Parent_Work_Order__c</elementReference>
            </value>
        </filters>
        <object>WorkOrder</object>
        <outputReference>WorkOrder</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Status</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Update_Status_to_SA</name>
        <label>Update Status to SA</label>
        <locationX>915</locationX>
        <locationY>1229</locationY>
        <inputReference>ServiceAppointment</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_WO_status</name>
        <label>Update WO status</label>
        <locationX>705</locationX>
        <locationY>1229</locationY>
        <connector>
            <targetReference>Update_Status_to_SA</targetReference>
        </connector>
        <inputReference>WorkOrder</inputReference>
    </recordUpdates>
    <screens>
        <name>Closing_of_Service_Appointment</name>
        <label>Closing of Service Appointment</label>
        <locationX>1415</locationX>
        <locationY>1016</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Set_new_end_time</targetReference>
        </connector>
        <fields>
            <name>Insert_Picture</name>
            <extensionName>forceContent:fileUpload</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>You can add picture to represent the Asset, if you want to. Otherwise, just click Finish.</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>recordId</name>
                <value>
                    <elementReference>ServiceAppointment.Id</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>multiple</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>End_time_can_be_adjusted_here</name>
            <dataType>DateTime</dataType>
            <defaultValue>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </defaultValue>
            <fieldText>End time can be adjusted here</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Installer_s_comments</name>
            <fieldText>Installer&apos;s comments</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Closing_of_Service_Appointment_0</name>
        <label>Closing of Service Appointment</label>
        <locationX>1524</locationX>
        <locationY>1160</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Set_new_end_time_0</targetReference>
        </connector>
        <fields>
            <name>End_time_can_be_adjusted_here_0</name>
            <dataType>DateTime</dataType>
            <defaultValue>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </defaultValue>
            <fieldText>End time can be adjusted here</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Installer_s_comments2</name>
            <fieldText>Installer&apos;s comments</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Enter_Mileage_Screen</name>
        <label>Enter Mileage</label>
        <locationX>1410</locationX>
        <locationY>663</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_SA_data2</targetReference>
        </connector>
        <fields>
            <name>Mileage_Input</name>
            <dataType>Number</dataType>
            <fieldText>Mileage to customer site</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>0</scale>
        </fields>
        <fields>
            <name>Trailer_Input</name>
            <dataType>Boolean</dataType>
            <defaultValue>
                <booleanValue>false</booleanValue>
            </defaultValue>
            <fieldText>Trailer was used</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status</name>
        <label>Get Status</label>
        <locationX>259</locationX>
        <locationY>547</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_None</targetReference>
        </connector>
        <fields>
            <name>Select_Status_None</name>
            <choiceReferences>Scheduled</choiceReferences>
            <choiceReferences>Canceled</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status_0</name>
        <label>Get Status</label>
        <locationX>370</locationX>
        <locationY>551</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_Scheduled</targetReference>
        </connector>
        <fields>
            <name>Select_Status_Scheduled</name>
            <choiceReferences>Dispatched</choiceReferences>
            <choiceReferences>Canceled</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status_1</name>
        <label>Get Status</label>
        <locationX>692</locationX>
        <locationY>560</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_Dispatched</targetReference>
        </connector>
        <fields>
            <name>Select_Status_Dispatched</name>
            <choiceReferences>Travel</choiceReferences>
            <choiceReferences>InProgress</choiceReferences>
            <choiceReferences>Canceled</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status_2</name>
        <label>Get Status</label>
        <locationX>487</locationX>
        <locationY>550</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_Travel</targetReference>
        </connector>
        <fields>
            <name>Select_Status_Travel</name>
            <choiceReferences>InProgress</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status_3</name>
        <label>Get Status</label>
        <locationX>579</locationX>
        <locationY>555</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_InProgress</targetReference>
        </connector>
        <fields>
            <name>Select_Status_InProgress</name>
            <choiceReferences>Completed</choiceReferences>
            <choiceReferences>CannotComplete</choiceReferences>
            <choiceReferences>Paused</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Status_4</name>
        <label>Get Status</label>
        <locationX>127</locationX>
        <locationY>345</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_status_Paused</targetReference>
        </connector>
        <fields>
            <name>Select_Status_Paused</name>
            <choiceReferences>Travel</choiceReferences>
            <choiceReferences>InProgress</choiceReferences>
            <choiceReferences>CannotComplete</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select Status</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>No_Assigned_Resource</name>
        <label>No Assigned Resource</label>
        <locationX>903</locationX>
        <locationY>365</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Error_No_AR</name>
            <fieldText>&lt;p&gt;Error! This Service Appointment does not have an Installer assigned to it. So it cannot be set to In Progress status.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>No_status_transition_available</name>
        <label>No status transition available</label>
        <locationX>691</locationX>
        <locationY>241</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Error_No_Status_Transition_Available</name>
            <fieldText>&lt;p&gt;Error! This Service Appointment is already completed. There are no status transitions to be made anymore.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Pausing_of_Service_Appointment</name>
        <label>Pausing of Service Appointment</label>
        <locationX>1128</locationX>
        <locationY>878</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Update_Status_to_SA</targetReference>
        </connector>
        <fields>
            <name>PausedInfoScreen</name>
            <fieldText>&lt;p&gt;You have now paused the Service Appointment. It can be resumed at later time.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Time_Sheet_notification</name>
        <label>Time Sheet notification</label>
        <locationX>479</locationX>
        <locationY>1424</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_WO_data</targetReference>
        </connector>
        <fields>
            <name>Nag_screen</name>
            <fieldText>&lt;p&gt;There is at least one earlier Time Sheet that is still open. Please send it for approval!&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Was_traveling_done</name>
        <label>Was traveling done?</label>
        <locationX>849</locationX>
        <locationY>669</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Mileage_to_be_input</targetReference>
        </connector>
        <fields>
            <name>Mileage_needs_to_be_entered</name>
            <dataType>Boolean</dataType>
            <defaultValue>
                <booleanValue>false</booleanValue>
            </defaultValue>
            <fieldText>Mileage needs to be entered</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>247</locationX>
        <locationY>87</locationY>
        <connector>
            <targetReference>Get_SA_data</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>All_picture_names</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ContentDocumentLinkAsset</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>ContentDocumentLinkSA</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>CreatedImageFileIDs</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CreatedImageFileNames</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Input value for the SA record from which this flow was started from.</description>
        <name>Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ImageId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ImageLink</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ServiceAppointment</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceAppointment</objectType>
    </variables>
    <variables>
        <name>Timesheet</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>TimeSheet</objectType>
    </variables>
    <variables>
        <name>Timesheets</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>TimeSheet</objectType>
    </variables>
    <variables>
        <name>Travel_TSE</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>TimeSheetEntry</objectType>
    </variables>
    <variables>
        <name>varNewEndTime</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>WorkOrder</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrder</objectType>
    </variables>
</Flow>
