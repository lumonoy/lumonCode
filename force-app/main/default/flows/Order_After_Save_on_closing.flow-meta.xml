<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <assignments>
        <name>Add_Asset</name>
        <label>Add Asset</label>
        <locationX>2457</locationX>
        <locationY>2568</locationY>
        <assignmentItems>
            <assignToReference>colAssets</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recAsset</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Assets</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Config_Plan_id</name>
        <label>Add Config Plan id</label>
        <locationX>1828</locationX>
        <locationY>1712</locationY>
        <assignmentItems>
            <assignToReference>colConfigPlanIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Configuration_Plans.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Configuration_Plans</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Service_Territory</name>
        <label>Assign Service Territory</label>
        <locationX>1806</locationX>
        <locationY>2219</locationY>
        <assignmentItems>
            <assignToReference>varServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Set_Configuration_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Blinds_Plans</name>
        <label>Count Blinds Plans</label>
        <locationX>1551</locationX>
        <locationY>1472</locationY>
        <assignmentItems>
            <assignToReference>nbrConfigPlans</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Filter_on_Blinds_Plans</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Blinds_Plans</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Configurable_Products</name>
        <label>Count Configurable Products</label>
        <locationX>1811</locationX>
        <locationY>1872</locationY>
        <assignmentItems>
            <assignToReference>nbrConfigurableProducts</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Configuration_Products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Are_there_Configurable_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_of_Assets</name>
        <label>Count of Assets</label>
        <locationX>2275</locationX>
        <locationY>2580</locationY>
        <assignmentItems>
            <assignToReference>nbrAssets</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>colAssets</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assets_to_create</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Deduplicate</name>
        <label>Deduplicate</label>
        <locationX>1097</locationX>
        <locationY>1199</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlansDeduplicated</assignToReference>
            <operator>RemoveAll</operator>
            <value>
                <elementReference>Configuration_Plans_Source</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colConfigurationPlansDeduplicated</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Configuration_Plans_Source</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Sorted_Configuration_Plans</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Asset</name>
        <label>Set Asset</label>
        <locationX>2456</locationX>
        <locationY>2439</locationY>
        <assignmentItems>
            <assignToReference>recAsset.Configuration_Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Assets.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>fxAssetName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Normal installation</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.ContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.ContactId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.LocationId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Delivery_Location__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.SerialNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Assets.RVN_Number__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Purchased</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sold without installation.</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.InstallDate</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.ManufactureDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Street</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Installation_Address__Street__s</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.City</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Installation_Address__City__s</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.PostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Installation_Address__PostalCode__s</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Country</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Customer_Country__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.ServiceTerritory__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varServiceTerritoryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recAsset.Order__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Asset</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Config_Plan_Ids</name>
        <label>Set Config Plan Ids</label>
        <locationX>1120</locationX>
        <locationY>1065</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlanIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Quote_Lines.Configuration_Plan__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Quote_Lines</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Configuration_Products</name>
        <label>Set Configuration Products</label>
        <locationX>1984</locationX>
        <locationY>2437</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Configuration_Products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Filter_on_Config_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Order_Items</name>
        <label>Set Order Items</label>
        <locationX>499</locationX>
        <locationY>361</locationY>
        <assignmentItems>
            <assignToReference>colOrderItems</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Order_Items</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Order_Items_exist</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Quote_Line_Ids</name>
        <label>Set Quote Line Ids</label>
        <locationX>814</locationX>
        <locationY>584</locationY>
        <assignmentItems>
            <assignToReference>colQuoteLineIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Order_Items.QuoteLineItemId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Order_Items</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Quote_Lines</name>
        <label>Set Quote Lines</label>
        <locationX>848</locationX>
        <locationY>841</locationY>
        <assignmentItems>
            <assignToReference>colQuoteLines</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Quote_Lines</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Quote_Lines</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <description>Asset without installation needs to be created only for Blinds.</description>
        <name>Filter_on_Blinds_Plans</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter on Blinds Plans</label>
        <locationX>1374</locationX>
        <locationY>1472</locationY>
        <assignNextValueToReference>currentItem_Filter_on_Blinds_Plans_0</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationPlansDeduplicated</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_on_Blinds_Plans_0.Plan_Type__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <stringValue>Blinds</stringValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Count_Blinds_Plans</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <description>If Blinds Configuration Product does not have installation time, then there is need to create an Asset for it.</description>
        <name>Filter_on_Config_Products</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter on Config Products</label>
        <locationX>2130</locationX>
        <locationY>2437</locationY>
        <assignNextValueToReference>currentItem_Filter_on_Config_Products_0</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationProducts</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_on_Config_Products_0.hasInstallationTime__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>false</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Loop_Assets</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Sorted_Configuration_Plans</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sorted Configuration Plans</label>
        <locationX>1263</locationX>
        <locationY>1199</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationPlansDeduplicated</collectionReference>
        <connector>
            <targetReference>Are_there_configuration_plans</targetReference>
        </connector>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Id</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <decisions>
        <name>Any_Blinds_Plans</name>
        <label>Any Blinds Plans?</label>
        <locationX>1543</locationX>
        <locationY>1603</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrConfigPlans</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Configuration_Plans</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_Quote_Lines</name>
        <label>Any Quote Lines?</label>
        <locationX>839</locationX>
        <locationY>964</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes7</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colQuoteLineIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Quote_Lines</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_Configurable_Products</name>
        <label>Are there Configurable Products</label>
        <locationX>1802</locationX>
        <locationY>2006</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes4</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrConfigurableProducts</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity_exists</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_configuration_plans</name>
        <label>Are there configuration plans?</label>
        <locationX>1255</locationX>
        <locationY>1355</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colConfigurationPlansDeduplicated</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Filter_on_Blinds_Plans</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_there_Quote_Lines</name>
        <label>Are there Quote Lines?</label>
        <locationX>607</locationX>
        <locationY>738</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes6</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colQuoteLineIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Quote_Lines</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Assets_to_create</name>
        <label>Assets to create?</label>
        <locationX>2267</locationX>
        <locationY>2707</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes8</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrAssets</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Assets</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Opportunity_exists</name>
        <label>Opportunity exists?</label>
        <locationX>1920</locationX>
        <locationY>2121</locationY>
        <defaultConnector>
            <targetReference>Assign_Service_Territory</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes9</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.OpportunityId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opportunity</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Order_Items_exist</name>
        <label>Order Items exist</label>
        <locationX>491</locationX>
        <locationY>487</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes5</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colOrderItems</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Order_Items</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>Runs when Order is activated.

2.2.2024: First version.</description>
    <environments>Default</environments>
    <formulas>
        <name>fxAssetName</name>
        <dataType>String</dataType>
        <expression>{!Loop_Assets.Name} &amp; &quot;: &quot; &amp; {!Opportunity.Installation_Address__Street__s}</expression>
    </formulas>
    <interviewLabel>Order - After Save on closing {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Order - After Save on closing</label>
    <loops>
        <name>Loop_Assets</name>
        <label>Loop Assets</label>
        <locationX>2275</locationX>
        <locationY>2437</locationY>
        <collectionReference>Filter_on_Config_Products</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Asset</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Count_of_Assets</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Go through the filtered list for any Blinds Plans.</description>
        <name>Loop_Configuration_Plans</name>
        <label>Loop Configuration Plans</label>
        <locationX>1655</locationX>
        <locationY>1712</locationY>
        <collectionReference>Filter_on_Blinds_Plans</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Config_Plan_id</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Configuration_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Order_Items</name>
        <label>Loop Order Items</label>
        <locationX>615</locationX>
        <locationY>584</locationY>
        <collectionReference>colOrderItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Quote_Line_Ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Are_there_Quote_Lines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Quote_Lines</name>
        <label>Loop Quote Lines</label>
        <locationX>942</locationX>
        <locationY>1065</locationY>
        <collectionReference>colQuoteLines</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Config_Plan_Ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Configuration_Plans_Source</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Assets</name>
        <label>Create Assets</label>
        <locationX>2374</locationX>
        <locationY>2814</locationY>
        <inputReference>colAssets</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Configuration_Plans_Source</name>
        <label>Configuration Plans Source</label>
        <locationX>942</locationX>
        <locationY>1199</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Deduplicate</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>colConfigurationPlanIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Configuration_Products</name>
        <label>Configuration Products</label>
        <locationX>1655</locationX>
        <locationY>1872</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_Configurable_Products</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Configuration__c</field>
            <operator>In</operator>
            <value>
                <elementReference>colConfigPlanIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration_Product__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Opportunity</name>
        <label>Opportunity</label>
        <locationX>2047</locationX>
        <locationY>2221</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Service_Territory</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.OpportunityId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get the Order line items to use to get the Quote LIne Items and through them the Order related Configuration Plan.</description>
        <name>Order_Items</name>
        <label>Order Items</label>
        <locationX>377</locationX>
        <locationY>361</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Order_Items</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Quote_Lines</name>
        <label>Quote Lines</label>
        <locationX>725</locationX>
        <locationY>841</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Quote_Lines</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>colQuoteLineIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>QuoteLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>251</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Order_Items</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <object>Order</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Draft</status>
    <subflows>
        <description>Resolves the Service Territory for the Asset to be created using the information available on the Opportunity.
Service Territory information should be made available on Asset.</description>
        <name>Get_Service_Territory</name>
        <label>Get Service Territory</label>
        <locationX>2165</locationX>
        <locationY>2221</locationY>
        <connector>
            <targetReference>Set_Configuration_Products</targetReference>
        </connector>
        <flowName>Assign_Service_Territory_SubFlow</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>$Record.OpportunityId</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>varServiceTerritoryId</assignToReference>
            <name>varServiceTerritoryId</name>
        </outputAssignments>
    </subflows>
    <variables>
        <name>colAssets</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Asset</objectType>
    </variables>
    <variables>
        <name>colConfigPlanIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigurationPlanIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigurationPlans</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration__c</objectType>
    </variables>
    <variables>
        <name>colConfigurationPlansDeduplicated</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration__c</objectType>
    </variables>
    <variables>
        <name>colConfigurationProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>colOrderItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>colQuoteLineIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colQuoteLines</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>QuoteLineItem</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_on_Blinds_Plans_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_on_Config_Products_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>currentItemFromSourceCollection</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>currentItemFromSourceCollection_0</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>nbrAssets</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrConfigPlans</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrConfigurableProducts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>recAsset</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Asset</objectType>
    </variables>
    <variables>
        <name>varServiceTerritoryId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
