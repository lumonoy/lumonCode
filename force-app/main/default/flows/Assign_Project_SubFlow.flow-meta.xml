<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Assign_main_project_values</name>
        <label>Assign main project values</label>
        <locationX>50</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>ParentProject.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ParentProject.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ParentProject.Project_Group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CONSALES</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ParentProject.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>InProgress</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ParentProject.Chargeable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ParentProject.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>MainProjectRecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Main_Project</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Project_Group</name>
        <label>Assign Project Group</label>
        <locationX>2514</locationX>
        <locationY>1379</locationY>
        <assignmentItems>
            <assignToReference>Get_Related_Project.Project_Group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>projectGroupVal</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Project_Group</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Project_to_Chargeable</name>
        <label>Assign Project to Chargeable</label>
        <locationX>1106</locationX>
        <locationY>1403</locationY>
        <assignmentItems>
            <assignToReference>SubProject.Chargeable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_existing_projects_for_opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Project_to_non_chargeable</name>
        <label>Assign Project to non chargeable</label>
        <locationX>1370</locationX>
        <locationY>1403</locationY>
        <assignmentItems>
            <assignToReference>SubProject.Chargeable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_existing_projects_for_opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Project_value</name>
        <label>Assign Project value</label>
        <locationX>50</locationX>
        <locationY>1403</locationY>
        <assignmentItems>
            <assignToReference>ParentProject.Project_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Main_Project_values.Project_Number__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Project_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_sub_project_values</name>
        <label>Assign sub project values</label>
        <locationX>1238</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>SubProject.Project_Group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CONSDELIV</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Parent_Project__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Project.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Proj_number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>subProjectIncrement</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Project_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>subProjectIncrement</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>InProgress</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>subProjectName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.Chargeable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SubProject.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>subProjectRecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Sub_Project</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_warranty_project_values</name>
        <label>Assign warranty project values</label>
        <locationX>50</locationX>
        <locationY>1727</locationY>
        <assignmentItems>
            <assignToReference>WarrantyProject.Project_Group__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CONWAR</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Project_Category__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Warranty</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Parent_Project__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ParentProject.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Project_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>warrantyprojectnumber</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>InProgress</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>warrantyprojectname</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.Chargeable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WarrantyProject.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>warrantyRecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_warranty_project</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Installation_Hours_for_Plans</name>
        <label>Set Installation Hours for Plans</label>
        <locationX>2602</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>nbrPlanInstallationHours</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Plans.EstimatedInstallationHours__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrPlanInstallationHoursTotal</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>nbrPlanInstallationHours</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Configuration_Plans</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Opportunity</name>
        <label>Set Opportunity</label>
        <locationX>1975</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>recOpportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Opportunity</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Opportunity_Created_Updated</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>Filter_on_Plans_with_Installation_Hours</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter on Plans with Installation Hours</label>
        <locationX>2514</locationX>
        <locationY>863</locationY>
        <assignNextValueToReference>currentItem_Filter_on_Plans_with_Installation_Hours</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Related_Configuration_Plans</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_on_Plans_with_Installation_Hours.hasInstallationTime__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Loop_Configuration_Plans</targetReference>
        </connector>
    </collectionProcessors>
    <decisions>
        <name>Check_Case_Classification</name>
        <label>Check Case Classification</label>
        <locationX>1238</locationX>
        <locationY>1295</locationY>
        <defaultConnector>
            <targetReference>Assign_Project_to_non_chargeable</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Chargeable_to_Customer</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity.Case__r.Process_Class__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>11</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Project_to_Chargeable</targetReference>
            </connector>
            <label>Chargeable to Customer</label>
        </rules>
    </decisions>
    <decisions>
        <description>If order type is normal or reclamation</description>
        <name>Check_Order_type</name>
        <label>Check Order type</label>
        <locationX>1172</locationX>
        <locationY>755</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Order_type_Normal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Order_type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Normal</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Main_Project_exists_and_open</targetReference>
            </connector>
            <label>Order type Normal</label>
        </rules>
        <rules>
            <name>Order_type_Reclamation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Order_type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Reclamation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Parent_Opportunity</targetReference>
            </connector>
            <label>Order type Reclamation</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check whether the related case holds warranty</description>
        <name>Is_warranty</name>
        <label>Is warranty</label>
        <locationX>1238</locationX>
        <locationY>1079</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Warranty_valid</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity.Case__r.Warranty_applies__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_warranty_project</targetReference>
            </connector>
            <label>Warranty valid</label>
        </rules>
        <rules>
            <name>Warranty_not_valid</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity.Case__r.Warranty_applies__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Parent_Project</targetReference>
            </connector>
            <label>Warranty not valid</label>
        </rules>
    </decisions>
    <decisions>
        <name>Main_Project_exists_and_open</name>
        <label>Main Project exists and open</label>
        <locationX>182</locationX>
        <locationY>863</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Main_Project_doesn_t_exist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity.Project_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Main_Project_RecordType</targetReference>
            </connector>
            <label>Main Project doesn&apos;t exist</label>
        </rules>
    </decisions>
    <decisions>
        <name>Opportunity_Created_Updated</name>
        <label>Opportunity Created/Updated</label>
        <locationX>1975</locationX>
        <locationY>647</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>New_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Order_type</targetReference>
            </connector>
            <label>New Opportunity</label>
        </rules>
        <rules>
            <name>Updated_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Related_Configuration_Plans</targetReference>
            </connector>
            <label>Updated Opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <description>To check whether parent project exists and decide outcomes based on the Status</description>
        <name>Parent_Project_exists</name>
        <label>Parent Project exists</label>
        <locationX>1238</locationX>
        <locationY>971</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Parent_Project_Open</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Project_Number__r.Project_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Project_Number__r.Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Relate_Cloned_Opp_to_Main_Project</targetReference>
            </connector>
            <label>Parent Project Open</label>
        </rules>
        <rules>
            <name>Parent_Project_Completed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Project_Number__r.Project_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Parent_Opportunity.Project_Number__r.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_warranty</targetReference>
            </connector>
            <label>Parent Project Completed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Skip_Automation</name>
        <label>Skip Automation?</label>
        <locationX>880</locationX>
        <locationY>323</locationY>
        <defaultConnector>
            <targetReference>Get_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Continue</defaultConnectorLabel>
        <rules>
            <name>Abort</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.AutomationBypass__c.SkipAutomation__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Abort</label>
        </rules>
    </decisions>
    <description>Flow to create the Umbrella Project for New Installations
08.06 - Added reclamation related logics to create or relate projects to the reclamation opp
21.06 - Added Project_Value__c new field to populate the project number value needed for integration
21.06 - Updated Project name value for subproject and added status to be populated inprogress for sub project
03.07 - Update chargeable__c value to TRUE/FALSE based on the project
04.07 - Updated case classification based chargeable
22.11.23 temp fix to add recordtypes
01.12.23 - Modified Additional_Order_11 value to 11 (Case Process Class API Name modification)
02.12.2023: Save Active Version as R2
27.02.2023 Setting Project type based on Business type + Installable Products LUM-2336
11.03.2024 Modified flow to update Project Group - LUM-2336</description>
    <environments>Default</environments>
    <formulas>
        <name>IsNew</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>projectGroupVal</name>
        <dataType>String</dataType>
        <expression>IF(({!recOpportunity.Business_Type_Attribute__c} == &apos;Consumer&apos;), 
IF(({!nbrPlanInstallationHoursTotal}&gt; 0),&apos;CONSALES&apos;,&apos;CONSDELIV&apos;), &apos;&apos;)</expression>
    </formulas>
    <formulas>
        <name>subProjectIncrement</name>
        <dataType>String</dataType>
        <expression>LEFT({!Get_existing_projects_for_opportunity.Proj_number__c}, LEN({!Get_existing_projects_for_opportunity.Proj_number__c}) - 2) + LPAD({!subprojectnumber},2, &apos;0&apos; )</expression>
    </formulas>
    <formulas>
        <name>subProjectName</name>
        <dataType>String</dataType>
        <expression>{!Get_Parent_Opportunity.Account.Name} + {!subProjectIncrement}</expression>
    </formulas>
    <formulas>
        <name>subprojectnumber</name>
        <dataType>String</dataType>
        <expression>TEXT(VALUE(RIGHT({!Get_existing_projects_for_opportunity.Proj_number__c}, 2))+01)</expression>
    </formulas>
    <formulas>
        <name>warrantyprojectname</name>
        <dataType>String</dataType>
        <expression>{!Get_Opportunity.Account.Name} + {!warrantyprojectnumber}</expression>
    </formulas>
    <formulas>
        <name>warrantyprojectnumber</name>
        <dataType>String</dataType>
        <expression>{!Get_Main_Project_values.Project_Number__c}+ &apos;_01&apos;</expression>
    </formulas>
    <interviewLabel>Assign Project {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity - Assign Project SubFlow R2.4</label>
    <loops>
        <name>Loop_Configuration_Plans</name>
        <label>Loop Configuration Plans</label>
        <locationX>2514</locationX>
        <locationY>971</locationY>
        <collectionReference>Filter_on_Plans_with_Installation_Hours</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Installation_Hours_for_Plans</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Related_Project</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Main_Project</name>
        <label>Create Main Project</label>
        <locationX>50</locationX>
        <locationY>1187</locationY>
        <connector>
            <targetReference>Get_Main_Project_values</targetReference>
        </connector>
        <inputReference>ParentProject</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_Sub_Project</name>
        <label>Create Sub Project</label>
        <locationX>1238</locationX>
        <locationY>1811</locationY>
        <connector>
            <targetReference>Relate_Cloned_Opp_with_Sub_Project</targetReference>
        </connector>
        <inputReference>SubProject</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_warranty_project</name>
        <label>Create warranty project</label>
        <locationX>50</locationX>
        <locationY>1835</locationY>
        <connector>
            <targetReference>Related_Opp_to_created_project</targetReference>
        </connector>
        <inputReference>WarrantyProject</inputReference>
    </recordCreates>
    <recordLookups>
        <description>Get all the existing projects from the opportunity</description>
        <name>Get_existing_projects_for_opportunity</name>
        <label>Get existing projects for opportunity</label>
        <locationX>1238</locationX>
        <locationY>1595</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_sub_project_values</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Parent_Opportunity.Project_Number__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Parent_Project__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Parent_Opportunity.Project_Number__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Project__c</object>
        <sortField>Project_Number__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Main_Project_RecordType</name>
        <label>Get Main Project RecordType</label>
        <locationX>50</locationX>
        <locationY>971</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_main_project_values</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Project__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Main</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputAssignments>
            <assignToReference>MainProjectRecordTypeId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Main_Project_values</name>
        <label>Get Main Project values</label>
        <locationX>50</locationX>
        <locationY>1295</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Project_value</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>ParentProject.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Project__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity</name>
        <label>Get Opportunity</label>
        <locationX>1975</locationX>
        <locationY>431</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Opportunity</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>To get the parent opportunity since it is reclamation there should be a parent opportunity for every cloned opportunity</description>
        <name>Get_Parent_Opportunity</name>
        <label>Get Parent Opportunity</label>
        <locationX>1238</locationX>
        <locationY>863</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Parent_Project_exists</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Opportunity.Parent_Opportunity__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Parent_Project</name>
        <label>Get Parent Project</label>
        <locationX>1238</locationX>
        <locationY>1187</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_Case_Classification</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Parent_Opportunity.Project_Number__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Project__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Related_Configuration_Plans</name>
        <label>Get Related Configuration Plans</label>
        <locationX>2514</locationX>
        <locationY>755</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Filter_on_Plans_with_Installation_Hours</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recOpportunity.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Related_Project</name>
        <label>Get Related Project</label>
        <locationX>2514</locationX>
        <locationY>1271</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Project_Group</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Opportunity.Project_Number__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Project__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_warranty_project</name>
        <label>Get warranty project</label>
        <locationX>842</locationX>
        <locationY>1187</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Relate_Cloned_Opp_to_Warranty_project</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Parent_Project__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Parent_Opportunity.Project_Number__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Project_Category__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Warranty</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Project__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Warranty_Project_RecordType</name>
        <label>Get Warranty Project RecordType</label>
        <locationX>50</locationX>
        <locationY>1619</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_warranty_project_values</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Project__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Warranty</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputAssignments>
            <assignToReference>warrantyRecordTypeId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Relate_Cloned_Opp_to_Main_Project</name>
        <label>Relate Cloned Opp to Main Project</label>
        <locationX>578</locationX>
        <locationY>1079</locationY>
        <inputAssignments>
            <field>Project_Number__c</field>
            <value>
                <elementReference>Get_Parent_Opportunity.Project_Number__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Relate_Cloned_Opp_to_Warranty_project</name>
        <label>Relate Cloned Opp to Warranty project</label>
        <locationX>842</locationX>
        <locationY>1295</locationY>
        <inputAssignments>
            <field>Project_Number__c</field>
            <value>
                <elementReference>Get_warranty_project.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Relate_Cloned_Opp_with_Sub_Project</name>
        <label>Relate Cloned Opp with Sub Project</label>
        <locationX>1238</locationX>
        <locationY>1919</locationY>
        <inputAssignments>
            <field>Project_Number__c</field>
            <value>
                <elementReference>SubProject.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Related_Opp_to_created_project</name>
        <label>Related Opp to created project</label>
        <locationX>50</locationX>
        <locationY>1943</locationY>
        <inputAssignments>
            <field>Project_Number__c</field>
            <value>
                <elementReference>ParentProject.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Project_Group</name>
        <label>Update Project Group</label>
        <locationX>2514</locationX>
        <locationY>1487</locationY>
        <inputReference>Get_Related_Project</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Project_Record</name>
        <label>Update Project Record</label>
        <locationX>50</locationX>
        <locationY>1511</locationY>
        <connector>
            <targetReference>Get_Warranty_Project_RecordType</targetReference>
        </connector>
        <inputReference>ParentProject</inputReference>
    </recordUpdates>
    <start>
        <locationX>754</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Skip_Automation</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Order_type__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Obsolete</status>
    <triggerOrder>105</triggerOrder>
    <variables>
        <name>currentItem_Filter_on_Plans_with_Installation_Hours</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration__c</objectType>
    </variables>
    <variables>
        <name>latestProjectNumber</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>Listofprojects</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>MainProject</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>MainProjectRecordTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>nbrPlanInstallationHours</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>nbrPlanInstallationHoursTotal</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>opportunityId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ParentProject</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <description>Projects to be created</description>
        <name>Projects</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>recOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>SubProject apart from main project and warratny</description>
        <name>SubProject</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>subProjectRecordTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>WarrantyProject</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Project__c</objectType>
    </variables>
    <variables>
        <name>warrantyRecordTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
