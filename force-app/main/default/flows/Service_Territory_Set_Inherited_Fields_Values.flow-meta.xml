<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Set_Parent_Territory</name>
        <label>Set Parent Territory</label>
        <locationX>1638</locationX>
        <locationY>719</locationY>
        <assignmentItems>
            <assignToReference>parentTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ParentTerritoryId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Parent_Id</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Parent_Territory_Values</name>
        <label>Set Parent Territory Values</label>
        <locationX>1378</locationX>
        <locationY>1043</locationY>
        <assignmentItems>
            <assignToReference>parentTerritoryCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.Country</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryOrganization</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.Organization__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryProfitCenter</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.ProfitCenter__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryOffice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.Office__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryDistrict</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.District__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerrritoryBusinessType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.Business_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryCustomerSegment</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.CustomerSegment__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>parentTerritoryTimezone</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Parent_Id.OperatingHoursId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Parent_Territory_Organization</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_territoryId</name>
        <label>Set territoryId</label>
        <locationX>1900</locationX>
        <locationY>395</locationY>
        <assignmentItems>
            <assignToReference>territoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Territory</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Parent_Territory_Business_Type</name>
        <label>Parent Territory Business Type</label>
        <locationX>226</locationX>
        <locationY>2231</locationY>
        <defaultConnector>
            <targetReference>Calculate_Customer_Business_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Parent Business Type</defaultConnectorLabel>
        <rules>
            <name>Parent_Business_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerrritoryBusinessType</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Business_Type</targetReference>
            </connector>
            <label>Parent Business Type</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Country</name>
        <label>Parent Territory Country?</label>
        <locationX>1122</locationX>
        <locationY>1367</locationY>
        <defaultConnectorLabel>No Parent Country</defaultConnectorLabel>
        <rules>
            <name>Parent_Country</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryCountry</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Country</targetReference>
            </connector>
            <label>Parent Country</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Customer_Segment</name>
        <label>Parent Territory Customer Segment</label>
        <locationX>50</locationX>
        <locationY>2447</locationY>
        <defaultConnector>
            <targetReference>Calculate_Customer_Segment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Parent Customer Segment</defaultConnectorLabel>
        <rules>
            <name>Parent_Customer_Segment</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryCustomerSegment</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Operating_Hours</targetReference>
            </connector>
            <label>Parent Customer Segment</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_District</name>
        <label>Parent Territory District?</label>
        <locationX>875</locationX>
        <locationY>1583</locationY>
        <defaultConnectorLabel>No Parent District</defaultConnectorLabel>
        <rules>
            <name>Parent_District</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryDistrict</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_District</targetReference>
            </connector>
            <label>Parent District</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Found</name>
        <label>Parent Territory Found?</label>
        <locationX>1638</locationX>
        <locationY>935</locationY>
        <defaultConnectorLabel>No Territory Record</defaultConnectorLabel>
        <rules>
            <name>Parent_Teritory_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Parent_Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Parent_Territory_Values</targetReference>
            </connector>
            <label>Parent Teritory Record</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Office</name>
        <label>Parent Territory Office?</label>
        <locationX>446</locationX>
        <locationY>2015</locationY>
        <defaultConnector>
            <targetReference>Update_Operating_Hours</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Parent Office</defaultConnectorLabel>
        <rules>
            <name>Parent_Office</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryOffice</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Office</targetReference>
            </connector>
            <label>Parent Office</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Organization</name>
        <label>Parent Territory Organization?</label>
        <locationX>1378</locationX>
        <locationY>1151</locationY>
        <defaultConnectorLabel>No Parent Organization</defaultConnectorLabel>
        <rules>
            <name>Parent_Organization</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryOrganization</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Organization</targetReference>
            </connector>
            <label>Parent Organization</label>
        </rules>
    </decisions>
    <decisions>
        <name>Parent_Territory_Profit_Center</name>
        <label>Parent Territory Profit Center?</label>
        <locationX>644</locationX>
        <locationY>1799</locationY>
        <defaultConnectorLabel>No Parent Profit Center</defaultConnectorLabel>
        <rules>
            <name>Parent_Profit_Center</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>parentTerritoryProfitCenter</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Profit_Center</targetReference>
            </connector>
            <label>Parent Profit Center</label>
        </rules>
    </decisions>
    <decisions>
        <description>Skip automation is a Custom Settings and allows for admin task to be executed without triggering automation</description>
        <name>Skip_Automation</name>
        <label>Skip Automation?</label>
        <locationX>799</locationX>
        <locationY>287</locationY>
        <defaultConnector>
            <targetReference>Set_territoryId</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.AutomationBypass__c.SkipAutomation__c</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Territory_Found</name>
        <label>Territory Found?</label>
        <locationX>1900</locationX>
        <locationY>611</locationY>
        <defaultConnectorLabel>No Territory Record</defaultConnectorLabel>
        <rules>
            <name>Teritory_Record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Territory</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Parent_Territory</targetReference>
            </connector>
            <label>Teritory Record</label>
        </rules>
    </decisions>
    <description>Flow to inherit all the attributes set in an parent record and add the Bussiness Type and Customer Segment if specified in name</description>
    <environments>Default</environments>
    <formulas>
        <name>CalculatedBusinessType</name>
        <dataType>String</dataType>
        <expression>IF( CONTAINS({!$Record.Name}, &quot;Consumer&quot;), &quot;1&quot;,
IF( CONTAINS({!$Record.Name}, &quot;Project&quot;), &quot;4&quot;, &quot;&quot;)
)</expression>
    </formulas>
    <formulas>
        <name>CalculatedCustomerSegment</name>
        <dataType>String</dataType>
        <expression>IF( CONTAINS({!$Record.Name}, &quot;Consumer Apartment Building&quot;), &quot;1000&quot;,
IF( CONTAINS({!$Record.Name}, &quot;Consumer Single House&quot;), &quot;1100&quot;, 
IF( CONTAINS({!$Record.Name}, &quot;Project New Construction&quot;), &quot;4000&quot;,
IF( CONTAINS({!$Record.Name}, &quot;Project Renovation&quot;), &quot;4100&quot;, &quot;&quot;)
)
)
)</expression>
    </formulas>
    <interviewLabel>Service Territory - Set Inherited Fields Values {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Service Territory - Set Inherited Fields Values</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Parent_Id</name>
        <label>Get Parent Id</label>
        <locationX>1638</locationX>
        <locationY>827</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Parent_Territory_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>parentTerritoryId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceTerritory</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Territory</name>
        <label>Get Territory</label>
        <locationX>1900</locationX>
        <locationY>503</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Territory_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>territoryId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceTerritory</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Calculate_Customer_Business_Type</name>
        <label>Calculate Customer Business Type</label>
        <locationX>402</locationX>
        <locationY>2339</locationY>
        <connector>
            <targetReference>Update_Operating_Hours</targetReference>
        </connector>
        <inputAssignments>
            <field>Business_Type__c</field>
            <value>
                <elementReference>CalculatedBusinessType</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Calculate_Customer_Segment</name>
        <label>Calculate Customer Segment</label>
        <locationX>138</locationX>
        <locationY>2555</locationY>
        <connector>
            <targetReference>Update_Operating_Hours</targetReference>
        </connector>
        <inputAssignments>
            <field>CustomerSegment__c</field>
            <value>
                <elementReference>CalculatedCustomerSegment</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Operating_Hours</name>
        <label>Update Territory Operating Hours</label>
        <locationX>446</locationX>
        <locationY>2915</locationY>
        <inputAssignments>
            <field>OperatingHoursId</field>
            <value>
                <elementReference>parentTerritoryTimezone</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Business_Type</name>
        <label>Update Record Business Type</label>
        <locationX>50</locationX>
        <locationY>2339</locationY>
        <connector>
            <targetReference>Parent_Territory_Customer_Segment</targetReference>
        </connector>
        <inputAssignments>
            <field>Business_Type__c</field>
            <value>
                <elementReference>parentTerrritoryBusinessType</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Country</name>
        <label>Update Record Country</label>
        <locationX>875</locationX>
        <locationY>1475</locationY>
        <connector>
            <targetReference>Parent_Territory_District</targetReference>
        </connector>
        <inputAssignments>
            <field>Country</field>
            <value>
                <elementReference>parentTerritoryCountry</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_District</name>
        <label>Update Record District</label>
        <locationX>644</locationX>
        <locationY>1691</locationY>
        <connector>
            <targetReference>Parent_Territory_Profit_Center</targetReference>
        </connector>
        <inputAssignments>
            <field>District__c</field>
            <value>
                <elementReference>parentTerritoryDistrict</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Office</name>
        <label>Update Record Office</label>
        <locationX>226</locationX>
        <locationY>2123</locationY>
        <connector>
            <targetReference>Parent_Territory_Business_Type</targetReference>
        </connector>
        <inputAssignments>
            <field>Office__c</field>
            <value>
                <elementReference>parentTerritoryOffice</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Organization</name>
        <label>Update Record Organization</label>
        <locationX>1122</locationX>
        <locationY>1259</locationY>
        <connector>
            <targetReference>Parent_Territory_Country</targetReference>
        </connector>
        <inputAssignments>
            <field>Organization__c</field>
            <value>
                <elementReference>parentTerritoryOrganization</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Profit_Center</name>
        <label>Update Record Profit Center</label>
        <locationX>446</locationX>
        <locationY>1907</locationY>
        <connector>
            <targetReference>Parent_Territory_Office</targetReference>
        </connector>
        <inputAssignments>
            <field>ProfitCenter__c</field>
            <value>
                <elementReference>parentTerritoryProfitCenter</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>673</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Skip_Automation</targetReference>
        </connector>
        <object>ServiceTerritory</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Obsolete</status>
    <variables>
        <name>parentTerritoryCountry</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryCustomerSegment</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryDistrict</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryOffice</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryOrganization</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryProfitCenter</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerritoryTimezone</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>parentTerrritoryBusinessType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>territoryId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
