<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Add_Prepared_WOLI</name>
        <label>Add Prepared WOLI</label>
        <locationX>994</locationX>
        <locationY>4058</locationY>
        <assignmentItems>
            <assignToReference>colPreparedWOLIs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>WOLIrecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Configuration_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Product_Id_To_Collection</name>
        <label>Add Product Id To Collection</label>
        <locationX>400</locationX>
        <locationY>4574</locationY>
        <assignmentItems>
            <assignToReference>colWOLIProductIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_WOLIs.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colWOLIRVNs</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_WOLIs.RVN_Number__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_ConfigurationPlands</name>
        <label>Add to ConfigurationPlands</label>
        <locationX>1175</locationX>
        <locationY>1514</locationY>
        <assignmentItems>
            <assignToReference>colConfigPlanIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Configuration_Plans.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Configuration_Plans</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_InstallableProductIds</name>
        <label>Add to InstallableProductIds</label>
        <locationX>994</locationX>
        <locationY>3542</locationY>
        <assignmentItems>
            <assignToReference>colInstallableProductIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colProductIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colConfigProductIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Installation_Hours</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_WOLI_To_Update</name>
        <label>Add WOLI To Update</label>
        <locationX>796</locationX>
        <locationY>6662</locationY>
        <assignmentItems>
            <assignToReference>colWOLIsToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recPartialMatchWOLI</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colWOLIToKeep</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recPartialMatchWOLI.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Existing_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Exact_Match</name>
        <label>Assign Exact Match</label>
        <locationX>972</locationX>
        <locationY>6170</locationY>
        <assignmentItems>
            <assignToReference>recExactMatchWOLI</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Existing_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrExactMatchCount</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colWOLIsToCreate</assignToReference>
            <operator>RemoveFirst</operator>
            <value>
                <elementReference>Loop_Prepared_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Prepared_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_No_Match</name>
        <label>Assign No Match</label>
        <locationX>1500</locationX>
        <locationY>6170</locationY>
        <assignmentItems>
            <assignToReference>nbrNoMatchCount</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Prepared_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Partial_Match</name>
        <label>Assign Partial Match</label>
        <locationX>1236</locationX>
        <locationY>6170</locationY>
        <assignmentItems>
            <assignToReference>recPartialMatchWOLI</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Existing_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>recPartialMatchWOLI.WorkTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recPreparedWOLI.WorkTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrPartialMatchCount</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colWOLIsToCreate</assignToReference>
            <operator>RemoveFirst</operator>
            <value>
                <elementReference>Loop_Prepared_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Prepared_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_Counters</name>
        <label>Clear Counters</label>
        <locationX>884</locationX>
        <locationY>5738</locationY>
        <assignmentItems>
            <assignToReference>nbrNoMatchCount</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrExactMatchCount</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrPartialMatchCount</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Prepared_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Configurable_Products</name>
        <label>Count Configurable Products</label>
        <locationX>1087</locationX>
        <locationY>1814</locationY>
        <assignmentItems>
            <assignToReference>nbrConfigurableProduct</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Configuration_Products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Configuration_Products_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Existing_WOLIs</name>
        <label>Count Existing WOLIs</label>
        <locationX>312</locationX>
        <locationY>4874</locationY>
        <assignmentItems>
            <assignToReference>nbrExistingWOLIs</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Existing_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Matching_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Installable_Products</name>
        <label>Count Installable Products</label>
        <locationX>807</locationX>
        <locationY>2246</locationY>
        <assignmentItems>
            <assignToReference>nbrInstallableProducts</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Filter_On_Installable_Product</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Filter_On_Reclamation_Product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Installation_Hours</name>
        <label>Count Installation Hours</label>
        <locationX>807</locationX>
        <locationY>3218</locationY>
        <assignmentItems>
            <assignToReference>nbrInstallationHours</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Filter_for_Installation_Hours</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Needs_Installation</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Prepared_WOLIs</name>
        <label>Count Prepared WOLIs</label>
        <locationX>510</locationX>
        <locationY>4250</locationY>
        <assignmentItems>
            <assignToReference>nbrPreparedWOLIs</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>colPreparedWOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>WOLIs_Prepared</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Reclamation_Products</name>
        <label>Count Reclamation Products</label>
        <locationX>807</locationX>
        <locationY>2462</locationY>
        <assignmentItems>
            <assignToReference>nbrReclamationProducts</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Filter_On_Reclamation_Product</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Filter_on_Service_Product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Service_Products</name>
        <label>Count Service Products</label>
        <locationX>807</locationX>
        <locationY>2678</locationY>
        <assignmentItems>
            <assignToReference>nbrServiceProducts</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Filter_on_Service_Product</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Installation_Work_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_WOLIs_to_Create</name>
        <label>Count WOLIs to Create</label>
        <locationX>312</locationX>
        <locationY>7022</locationY>
        <assignmentItems>
            <assignToReference>nbrWOLIsToCreate</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>colWOLIsToCreate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_WOLIs_To_Create</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_WOLIs_to_Delete</name>
        <label>Count WOLIs to Delete</label>
        <locationX>708</locationX>
        <locationY>8438</locationY>
        <assignmentItems>
            <assignToReference>nbrWOLIsToDelete</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Work_Order_Line_Items_To_Delete</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_WOLIs_To_Delete</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_WOLIs_to_Update</name>
        <label>Count WOLIs to Update</label>
        <locationX>312</locationX>
        <locationY>7730</locationY>
        <assignmentItems>
            <assignToReference>nbrWOLIsToUpdate</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>colWOLIsToUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_WOLIs_To_Update</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Increase_Loop_Counter</name>
        <label>Increase Loop Counter</label>
        <locationX>884</locationX>
        <locationY>6446</locationY>
        <assignmentItems>
            <assignToReference>nbrLoopCounter</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Which_Action_to_Perform_on_WOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Prepare_Installable_Work_Order_Line_Items</name>
        <label>Prepare Installable Work Order Line Items</label>
        <locationX>598</locationX>
        <locationY>3866</locationY>
        <assignmentItems>
            <assignToReference>WOLIrecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Installation Work</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.ServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.ServiceTerritoryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varInstallationWorkTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.RVN_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.RVN__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Duration</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nbrInstallationHours</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.DurationType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Hours</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Is_installable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Configuration_Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Street</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Street</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.City</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.City</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.PostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.PostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Country</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Country</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Prepared_WOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Prepare_Reclamation_Work_Order_Line_Items</name>
        <label>Prepare Reclamation Work Order Line Items</label>
        <locationX>862</locationX>
        <locationY>3866</locationY>
        <assignmentItems>
            <assignToReference>WOLIrecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Reclamation</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.ServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.ServiceTerritoryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varReclamationWorkTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.RVN_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.RVN__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Is_installable__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Configuration_Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Is_Reclamation__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Configuration__r.Order__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Duration</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nbrInstallationHours</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.DurationType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Hours</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Street</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Street</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.City</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.City</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.PostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.PostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Country</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Country</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Prepared_WOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Prepare_Service_Work_Order_Line_Items</name>
        <label>Prepare Service Work Order Line Items</label>
        <locationX>1126</locationX>
        <locationY>3866</locationY>
        <assignmentItems>
            <assignToReference>WOLIrecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Additional Service</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.ServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.ServiceTerritoryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.WorkTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varServiceWorkTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Product__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.RVN_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.RVN__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Duration</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nbrInstallationHours</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.DurationType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Hours</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Configuration_Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Street</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Street</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.City</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.City</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.PostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.PostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WOLIrecord.Country</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Country</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Prepared_WOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Remove_WOLI_from_Collection</name>
        <label>Remove WOLI from Collection</label>
        <locationX>532</locationX>
        <locationY>6662</locationY>
        <assignmentItems>
            <assignToReference>colWOLIToKeep</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>recExactMatchWOLI.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>colExistingWOLIs</assignToReference>
            <operator>RemoveFirst</operator>
            <value>
                <elementReference>recExactMatchWOLI</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Existing_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Case_Configuration_Plans</name>
        <label>Set Case Configuration Plans</label>
        <locationX>831</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlans</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Case_Configurations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Configuration_Plans_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_CaseId</name>
        <label>Set CaseId</label>
        <locationX>831</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>caseId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.CaseId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Case</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Configuration_Plans</name>
        <label>Set Configuration Plans</label>
        <locationX>1359</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlans</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Configuration</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Configuration_Plans_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Configuration_Products</name>
        <label>Set Configuration Products</label>
        <locationX>807</locationX>
        <locationY>2030</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Configuration_Products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Filter_On_Installable_Product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_ConfigurationPlanId</name>
        <label>Set ConfigurationPlanId</label>
        <locationX>1359</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>configPlanId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Configuration_Plan__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Configuration</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Existing_WOLI</name>
        <label>Set Existing WOLI</label>
        <locationX>884</locationX>
        <locationY>5630</locationY>
        <assignmentItems>
            <assignToReference>recExistingWOLI</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Existing_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Clear_Counters</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Existing_WOLIs</name>
        <label>Set Existing WOLIs</label>
        <locationX>180</locationX>
        <locationY>5090</locationY>
        <assignmentItems>
            <assignToReference>colExistingWOLIs</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Existing_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Sort_Existing_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Element to retrieve the Installation Hours from Configuration Product and update the variables</description>
        <name>Set_Installation_Hours</name>
        <label>Set Installation Hours</label>
        <locationX>994</locationX>
        <locationY>3650</locationY>
        <assignmentItems>
            <assignToReference>nbrInstallationHours</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Configuration_Products.Installation_Hours__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nbrInstallationHoursTotal</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>nbrInstallationHours</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Which_Work_Type_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_New_WOLI_to_Keep</name>
        <label>Set New WOLI to Keep</label>
        <locationX>268</locationX>
        <locationY>7454</locationY>
        <assignmentItems>
            <assignToReference>colWOLIToKeep</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_New_WOLIs.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_New_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_New_WOLIs</name>
        <label>Set New WOLIs</label>
        <locationX>444</locationX>
        <locationY>5090</locationY>
        <assignmentItems>
            <assignToReference>colWOLIsToCreate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>colPreparedWOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Count_WOLIs_to_Create</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Opportunity_Configuration_Plans</name>
        <label>Set Opportunity Configuration Plans</label>
        <locationX>1095</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlans</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Opportunity_Configurations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Configuration_Plans_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_OpportunityId</name>
        <label>Set OpportunityId</label>
        <locationX>1095</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>opportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Opportunity__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Order_Configuration_Plans</name>
        <label>Set Order Configuration Plans</label>
        <locationX>1623</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>colConfigurationPlans</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Order_Configurations</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Any_Configuration_Plans_To_Process</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_OrderId</name>
        <label>Set OrderId</label>
        <locationX>1623</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>orderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Order__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Order</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Prepared_WOLI</name>
        <label>Set Prepared WOLI</label>
        <locationX>1236</locationX>
        <locationY>5954</locationY>
        <assignmentItems>
            <assignToReference>recPreparedWOLI</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Prepared_WOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_Matching_WOLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WOLIs_To_Create</name>
        <label>Set WOLIs To Create</label>
        <locationX>180</locationX>
        <locationY>5414</locationY>
        <assignmentItems>
            <assignToReference>colWOLIsToCreate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>colPreparedWOLIs</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Existing_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WOLIs_To_Delete</name>
        <label>Set WOLIs To Delete</label>
        <locationX>576</locationX>
        <locationY>8654</locationY>
        <assignmentItems>
            <assignToReference>colWOLIsToDelete</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Work_Order_Line_Items_To_Delete</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Delete_WOLIs</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WorkOrderId</name>
        <label>Set WorkOrderId</label>
        <locationX>1359</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>workorderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_WorkOrder.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Has_Order</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <description>Check for hasInstallationTime which means there is related Configuration Options that are Installation Time</description>
        <name>Filter_for_Installation_Hours</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter for Installation Hours</label>
        <locationX>807</locationX>
        <locationY>3110</locationY>
        <assignNextValueToReference>currentItem_Filter_for_Installation_Hours</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationProducts</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_for_Installation_Hours.hasInstallationTime__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Count_Installation_Hours</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <description>Check for the Installation Flag from Product2</description>
        <name>Filter_On_Installable_Product</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter On Installable Product</label>
        <locationX>807</locationX>
        <locationY>2138</locationY>
        <assignNextValueToReference>currentItem_Filter_On_Reclamation_Flag</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationProducts</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_On_Reclamation_Flag.Installable_Product__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Count_Installable_Products</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <description>Check for Reclamation Flag from Product2</description>
        <name>Filter_On_Reclamation_Product</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter On Reclamation Product</label>
        <locationX>807</locationX>
        <locationY>2354</locationY>
        <assignNextValueToReference>currentItem_Filter_On_Reclamation_Flag</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationProducts</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_On_Reclamation_Flag.Reclamation_Product__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Count_Reclamation_Products</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <description>Check the Service Flag on Product2</description>
        <name>Filter_on_Service_Product</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter on Service Product</label>
        <locationX>807</locationX>
        <locationY>2570</locationY>
        <assignNextValueToReference>currentItem_Filter_on_Service_Items</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>colConfigurationProducts</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_on_Service_Items.Service_Product__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Count_Service_Products</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Sort_Existing_WOLIs</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sort Existing WOLIs</label>
        <locationX>180</locationX>
        <locationY>5198</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>colExistingWOLIs</collectionReference>
        <connector>
            <targetReference>Sort_Prepared_WOLIs</targetReference>
        </connector>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Configuration_Product__c</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>WorkTypeId</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Is_installable__c</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <collectionProcessors>
        <name>Sort_Prepared_WOLIs</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sort Prepared WOLIs</label>
        <locationX>180</locationX>
        <locationY>5306</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>colPreparedWOLIs</collectionReference>
        <connector>
            <targetReference>Set_WOLIs_To_Create</targetReference>
        </connector>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Configuration_Product__c</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>WorkTypeId</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Is_installable__c</sortField>
            <sortOrder>Asc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <decisions>
        <name>Any_Configuration_Plans_To_Process</name>
        <label>Any Configuration Plans To Process?</label>
        <locationX>1359</locationX>
        <locationY>1190</locationY>
        <defaultConnectorLabel>No Configuration Plans</defaultConnectorLabel>
        <rules>
            <name>Configuration_Plans</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colConfigurationPlans</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_WorkTypes</targetReference>
            </connector>
            <label>Configuration Plans</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_Configuration_Products_To_Process</name>
        <label>Any Configuration Products To Process?</label>
        <locationX>1087</locationX>
        <locationY>1922</locationY>
        <defaultConnectorLabel>No Configuration Products</defaultConnectorLabel>
        <rules>
            <name>Configuration_Products</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrConfigurableProduct</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Configuration_Products</targetReference>
            </connector>
            <label>Configuration Products</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_Matching_WOLIs</name>
        <label>Any Matching WOLIs?</label>
        <locationX>312</locationX>
        <locationY>4982</locationY>
        <defaultConnector>
            <targetReference>Set_New_WOLIs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Matching WOLIs</defaultConnectorLabel>
        <rules>
            <name>Matching_WOLIs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrExistingWOLIs</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Existing_WOLIs</targetReference>
            </connector>
            <label>Matching WOLIs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_WOLIs_To_Create</name>
        <label>Any WOLIs To Create?</label>
        <locationX>312</locationX>
        <locationY>7130</locationY>
        <defaultConnector>
            <targetReference>Count_WOLIs_to_Update</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No New WOLIs</defaultConnectorLabel>
        <rules>
            <name>New_WOLIs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colWOLIsToCreate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>nbrWOLIsToCreate</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_WOLIs</targetReference>
            </connector>
            <label>New WOLIs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_WOLIs_To_Delete</name>
        <label>Any WOLIs To Delete?</label>
        <locationX>708</locationX>
        <locationY>8546</locationY>
        <defaultConnectorLabel>No Obsolete WOLIs</defaultConnectorLabel>
        <rules>
            <name>Obsolete_WOLIs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Work_Order_Line_Items_To_Delete</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_WOLIs_To_Delete</targetReference>
            </connector>
            <label>Obsolete WOLIs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Any_WOLIs_To_Update</name>
        <label>Any WOLIs To Update?</label>
        <locationX>312</locationX>
        <locationY>7838</locationY>
        <defaultConnector>
            <targetReference>Do_not_delete_anything_if_reclamation_case</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Changed WOLIs</defaultConnectorLabel>
        <rules>
            <name>Changed_WOLIs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>colWOLIsToUpdate</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>nbrWOLIsToUpdate</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_WOLIs</targetReference>
            </connector>
            <label>Changed WOLIs</label>
        </rules>
    </decisions>
    <decisions>
        <name>Do_not_delete_anything_if_reclamation_case</name>
        <label>Do not delete anything, if reclamation case</label>
        <locationX>510</locationX>
        <locationY>8222</locationY>
        <defaultConnector>
            <targetReference>Get_Work_Order_Line_Items_To_Delete</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Non-reclamation case</defaultConnectorLabel>
        <rules>
            <name>Reclamation_case</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>caseId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <label>Reclamation case</label>
        </rules>
    </decisions>
    <decisions>
        <name>Found_WorkOrder</name>
        <label>Found WorkOrder?</label>
        <locationX>1755</locationX>
        <locationY>350</locationY>
        <defaultConnectorLabel>No WorkOrder</defaultConnectorLabel>
        <rules>
            <name>WorkOrder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrder</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_WorkOrderId</targetReference>
            </connector>
            <label>WorkOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_Order</name>
        <label>Has Order?</label>
        <locationX>1359</locationX>
        <locationY>566</locationY>
        <defaultConnectorLabel>No Relation</defaultConnectorLabel>
        <rules>
            <name>Case</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrder.CaseId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_CaseId</targetReference>
            </connector>
            <label>Case</label>
        </rules>
        <rules>
            <name>Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrder.Opportunity__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_OpportunityId</targetReference>
            </connector>
            <label>Opportunity</label>
        </rules>
        <rules>
            <name>Configuration</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrder.Configuration_Plan__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_ConfigurationPlanId</targetReference>
            </connector>
            <label>Configuration</label>
        </rules>
        <rules>
            <name>Order</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_WorkOrder.Order__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_OrderId</targetReference>
            </connector>
            <label>Order</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Matching_WOLI</name>
        <label>Is Matching WOLI?</label>
        <locationX>1236</locationX>
        <locationY>6062</locationY>
        <defaultConnector>
            <targetReference>Assign_No_Match</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Match</defaultConnectorLabel>
        <rules>
            <name>Exact_Match</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recExistingWOLI.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.Product__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.WorkTypeId</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.WorkTypeId</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.RVN_Number__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.RVN_Number__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.Configuration_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.Configuration_Product__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Exact_Match</targetReference>
            </connector>
            <label>Exact Match</label>
        </rules>
        <rules>
            <name>Different_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recExistingWOLI.Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.Product__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.WorkTypeId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.WorkTypeId</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.RVN_Number__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.RVN_Number__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>recExistingWOLI.Configuration_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>recPreparedWOLI.Configuration_Product__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Partial_Match</targetReference>
            </connector>
            <label>Different Type</label>
        </rules>
    </decisions>
    <decisions>
        <name>Needs_Installation</name>
        <label>Needs Installation?</label>
        <locationX>807</locationX>
        <locationY>3326</locationY>
        <defaultConnectorLabel>No Installation Required</defaultConnectorLabel>
        <rules>
            <name>Installation_Required</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>nbrInstallationHours</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Configuration_Products</targetReference>
            </connector>
            <label>Installation Required</label>
        </rules>
    </decisions>
    <decisions>
        <name>Skip_Automation</name>
        <label>Skip Automation?</label>
        <locationX>176</locationX>
        <locationY>134</locationY>
        <defaultConnector>
            <targetReference>Get_WorkOrder</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Continue</defaultConnectorLabel>
        <rules>
            <name>Abort</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.AutomationBypass__c.SkipAutomation__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Abort</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Action_to_Perform_on_WOLI</name>
        <label>Which Action to Perform on WOLI?</label>
        <locationX>884</locationX>
        <locationY>6554</locationY>
        <defaultConnector>
            <targetReference>Loop_Existing_WOLIs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Check</defaultConnectorLabel>
        <rules>
            <name>Keep</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrExactMatchCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>nbrPartialMatchCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Remove_WOLI_from_Collection</targetReference>
            </connector>
            <label>Keep</label>
        </rules>
        <rules>
            <name>Update</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>nbrExactMatchCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>nbrPartialMatchCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_WOLI_To_Update</targetReference>
            </connector>
            <label>Update</label>
        </rules>
        <rules>
            <name>Create</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrNoMatchCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>nbrLoopCounter</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Existing_WOLIs</targetReference>
            </connector>
            <label>Create</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Work_Type_0</name>
        <label>Which Work Type?</label>
        <locationX>994</locationX>
        <locationY>3758</locationY>
        <defaultConnectorLabel>Other Work</defaultConnectorLabel>
        <rules>
            <name>Installation_Work_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrInstallableProducts</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Prepare_Installable_Work_Order_Line_Items</targetReference>
            </connector>
            <label>Installation Work</label>
        </rules>
        <rules>
            <name>Reclamation_Work_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrReclamationProducts</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Prepare_Reclamation_Work_Order_Line_Items</targetReference>
            </connector>
            <label>Reclamation Work</label>
        </rules>
        <rules>
            <name>Service_Work_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrServiceProducts</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Prepare_Service_Work_Order_Line_Items</targetReference>
            </connector>
            <label>Service Work</label>
        </rules>
    </decisions>
    <decisions>
        <name>WOLIs_Prepared</name>
        <label>WOLIs Prepared?</label>
        <locationX>510</locationX>
        <locationY>4358</locationY>
        <defaultConnector>
            <targetReference>Do_not_delete_anything_if_reclamation_case</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Prepared WOLIs</defaultConnectorLabel>
        <rules>
            <name>Prepared_WOLIs</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrPreparedWOLIs</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_WOLIs</targetReference>
            </connector>
            <label>Prepared WOLIs</label>
        </rules>
    </decisions>
    <description>17.1.2023: Revised duplicate detection and removal logic.
16.1.2023: Added duplicate removal logic.
13.01.2023 Updated Logic to use &quot;installable Product&quot; Field from Opportunity Product
9.12.2022: Removed unnecessary references.
8.12.2022: Separate handling for Installable, Reclamation and Service products. Work Type handling logic also added.
5.12.2022: determination based on Cost Type.
22.02.2022: Update logic to find Main Product
23.02.2022: Switch to QuoteLine?
10.3.2023: Copy address from WO to WOLI.
21.03.2023 Fixed Bug where WOLI was created for unrelated Service Item
15.05.2023 Fix Installation Times
9.6.2023: Fix for unnecessary WOLI deletion in Reclamation case.
27.6.2023: RVN number now fetched correctly in reclamations.
27.6.2023: Order is added to the WOLI in Reclamations case.
28.6.2023: Modifications to support installation times calculation also for Reclamation products. Change to Free-form..
29.6.2023: Set fixed time (and missing data) for reclamation and service WOLIs
16.08.2023: Updated Product Group Field in Get Service Items element
03.10.2023: Change the Order of Conditions in &quot;Has Order? decisions element
30.10.2023: Change the Order of Conditions in &quot;Has Order? decisions element Case then Opportunity
01.11.2023: Updated Version after Installation Time update
02.12.2023: Save Active Version as R2</description>
    <environments>Default</environments>
    <formulas>
        <name>fxInstallationMinutes</name>
        <dataType>Number</dataType>
        <expression>{!nbrInstallationHours}*60</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>fxInstallationTimeResult</name>
        <dataType>Number</dataType>
        <expression>{!nbrInstallationTimeEntryHours}*{!InstallationItemQuantity}</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>WO - Create WOLIs {!$Flow.CurrentDateTime}</interviewLabel>
    <label>WO - Create WOLIs R2</label>
    <loops>
        <name>Loop_Configuration_Plans</name>
        <label>Loop Configuration Plans</label>
        <locationX>1087</locationX>
        <locationY>1406</locationY>
        <collectionReference>colConfigurationPlans</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_to_ConfigurationPlands</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Configuration_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Configuration_Products</name>
        <label>Loop Configuration Products</label>
        <locationX>510</locationX>
        <locationY>3434</locationY>
        <collectionReference>Filter_for_Installation_Hours</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_to_InstallableProductIds</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Count_Prepared_WOLIs</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Existing_WOLIs</name>
        <label>Loop Existing WOLIs</label>
        <locationX>180</locationX>
        <locationY>5522</locationY>
        <collectionReference>colExistingWOLIs</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Existing_WOLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Count_WOLIs_to_Create</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_New_WOLIs</name>
        <label>Loop New WOLIs</label>
        <locationX>180</locationX>
        <locationY>7346</locationY>
        <collectionReference>colWOLIsToCreate</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_New_WOLI_to_Keep</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Count_WOLIs_to_Update</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Prepared_WOLIs</name>
        <label>Loop Prepared WOLIs</label>
        <locationX>884</locationX>
        <locationY>5846</locationY>
        <collectionReference>colPreparedWOLIs</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Prepared_WOLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Increase_Loop_Counter</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_WOLIs</name>
        <label>Loop WOLIs</label>
        <locationX>312</locationX>
        <locationY>4466</locationY>
        <collectionReference>colPreparedWOLIs</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Product_Id_To_Collection</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_Existing_WOLIs</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_WOLIs</name>
        <label>Create WOLIs</label>
        <locationX>180</locationX>
        <locationY>7238</locationY>
        <connector>
            <targetReference>Loop_New_WOLIs</targetReference>
        </connector>
        <inputReference>colWOLIsToCreate</inputReference>
    </recordCreates>
    <recordDeletes>
        <name>Delete_WOLIs</name>
        <label>Delete WOLIs</label>
        <locationX>576</locationX>
        <locationY>8762</locationY>
        <inputReference>colWOLIsToDelete</inputReference>
    </recordDeletes>
    <recordLookups>
        <name>Get_Case</name>
        <label>Get Case</label>
        <locationX>831</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Case_Configurations</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>caseId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Case_Configurations</name>
        <label>Get Case Configuration(s)</label>
        <locationX>831</locationX>
        <locationY>890</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Case_Configuration_Plans</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Case__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>caseId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Configuration</name>
        <label>Get Configuration</label>
        <locationX>1359</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Configuration_Plans</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>configPlanId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Configuration_Products</name>
        <label>Get Configuration Products</label>
        <locationX>1087</locationX>
        <locationY>1706</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_Configurable_Products</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Configuration__c</field>
            <operator>In</operator>
            <value>
                <elementReference>colConfigPlanIds</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration_Product__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Pre-existing Work Order Line Items are loaded for comparison.</description>
        <name>Get_Existing_WOLIs</name>
        <label>Get Existing WOLIs</label>
        <locationX>312</locationX>
        <locationY>4766</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_Existing_WOLIs</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WorkOrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>workorderId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WorkOrderLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Installation_Work_Type</name>
        <label>Get Installation Work Type</label>
        <locationX>807</locationX>
        <locationY>2786</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Reclamation_Work_Type</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>New Product installation</stringValue>
            </value>
        </filters>
        <object>WorkType</object>
        <outputAssignments>
            <assignToReference>varInstallationWorkTypeId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity</name>
        <label>Get Opportunity</label>
        <locationX>1095</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Opportunity_Configurations</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>opportunityId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity_Configurations</name>
        <label>Get Opportunity Configuration(s)</label>
        <locationX>1095</locationX>
        <locationY>890</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Opportunity_Configuration_Plans</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>opportunityId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order</name>
        <label>Get Order</label>
        <locationX>1623</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Order_Configurations</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>orderId</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Order_Configurations</name>
        <label>Get Order Configuration(s)</label>
        <locationX>1623</locationX>
        <locationY>890</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_Order_Configuration_Plans</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Order__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>orderId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Configuration__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Reclamation_Work_Type</name>
        <label>Get Reclamation Work Type</label>
        <locationX>807</locationX>
        <locationY>2894</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Service_Work_Type</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Reclamation work</stringValue>
            </value>
        </filters>
        <object>WorkType</object>
        <outputAssignments>
            <assignToReference>varReclamationWorkTypeId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Service_Work_Type</name>
        <label>Get Service Work Type</label>
        <locationX>807</locationX>
        <locationY>3002</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Filter_for_Installation_Hours</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Other work</stringValue>
            </value>
        </filters>
        <object>WorkType</object>
        <outputAssignments>
            <assignToReference>varServiceWorkTypeId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <description>Pre-existing Work Order Line Items that are Obsolete</description>
        <name>Get_Work_Order_Line_Items_To_Delete</name>
        <label>Get Work Order Line Items To Delete</label>
        <locationX>708</locationX>
        <locationY>8330</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_WOLIs_to_Delete</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WorkOrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_WorkOrder.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>NotIn</operator>
            <value>
                <elementReference>colWOLIToKeep</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WorkOrderLineItem</object>
        <sortField>LineItemNumber</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_WorkOrder</name>
        <label>Get WorkOrder</label>
        <locationX>1755</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_WorkOrder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_WorkTypes</name>
        <label>Get WorkTypes</label>
        <locationX>1087</locationX>
        <locationY>1298</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_Configuration_Plans</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>IsDeleted</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WorkType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_WOLIs</name>
        <label>Update WOLIs</label>
        <locationX>180</locationX>
        <locationY>7946</locationY>
        <connector>
            <targetReference>Do_not_delete_anything_if_reclamation_case</targetReference>
        </connector>
        <inputReference>colWOLIsToUpdate</inputReference>
    </recordUpdates>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Skip_Automation</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>AllOpportunityProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>caseId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigItemIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigPlanIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colConfigurationPlans</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration__c</objectType>
    </variables>
    <variables>
        <name>colConfigurationProducts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>colExistingWOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>colInstallableProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colInstallationProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colNewWorkOrderLineItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>colPreparedWOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>colProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colReclamationProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colServiceItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>colWOLIProductIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colWOLIRVNs</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colWOLIsToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <description>WOLIs that don&apos;t have (anymore) a matching Opportunity Product. These WOLIs are unnecessary and can be removed.</description>
        <name>colWOLIsToDelete</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>colWOLIsToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>colWOLIToKeep</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colWorkOrderIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>colWorkTypes</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkType</objectType>
    </variables>
    <variables>
        <name>configPlanId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CountofOpportunityProducts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>countOfWOLIsToDelete</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>currentItem_All_Reclamation_WOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_for_Installation_Hours</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_New_Installation_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_on_Additional_Services</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Product2</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_On_Installation_Items_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Option__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_On_Installation_Products_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkType</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_On_Reclamation_Flag</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_On_Related_installation_Times</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Option__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_on_Service_Items</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Configuration_Product__c</objectType>
    </variables>
    <variables>
        <name>InstallableProductWOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>InstallableServiceWOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>InstallationItemQuantity</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>MatchingWOLI</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrConfigurableProduct</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrExactMatchCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>nbrExistingWOLIs</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrInstallableProducts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrInstallationHours</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>nbrInstallationHoursTotal</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>nbrInstallationItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrInstallationTimeEntryHours</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>nbrInstallationTimes</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrLoopCounter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>nbrNoMatchCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>nbrPartialMatchCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>nbrPreparedWOLIs</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrReclamationProducts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrServiceProducts</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>nbrWOLIsToCreate</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrWOLIsToDelete</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>nbrWOLIsToUpdate</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>numberOfInstallableWOLIs</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>NumberOfNewInstItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>NumberOfNewReclItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>NumberOfNewServiceItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>numberOfReclamationWOLIs</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>numberOfServiceWOLIs</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>opportunityId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>orderId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recExactMatchWOLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>recExistingWOLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>ReclamationWOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>recOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recPartialMatchWOLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>recPreparedWOLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>txtWorkType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varInstallationWorkTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varReclamationWorkTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varServiceWorkTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varWorkTypeId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>WOLIrecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrderLineItem</objectType>
    </variables>
    <variables>
        <name>workorderId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
