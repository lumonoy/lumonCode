<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Assign_the_correct_collection_to_use</name>
        <label>Assign the correct collection to use</label>
        <locationX>1723</locationX>
        <locationY>1555</locationY>
        <assignmentItems>
            <assignToReference>STcollection</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PC_Business_Type</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Territories_Single</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Territories</name>
        <label># Service Territories</label>
        <locationX>1484</locationX>
        <locationY>1053</locationY>
        <assignmentItems>
            <assignToReference>nbrCountServiceTerritories</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Service_Territories</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>STcollection</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Service_Territories</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Service_Territory_Found</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Territories_2</name>
        <label># Service Territories</label>
        <locationX>1713</locationX>
        <locationY>1300</locationY>
        <assignmentItems>
            <assignToReference>nbrCountServiceTerritories</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Service_Territories_4</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Territories_3</name>
        <label># Service Territories</label>
        <locationX>2078</locationX>
        <locationY>1563</locationY>
        <assignmentItems>
            <assignToReference>nbrCountServiceTerritories</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Service_Territories_5</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Territories_4</name>
        <label># Service Territories</label>
        <locationX>1843</locationX>
        <locationY>1300</locationY>
        <assignmentItems>
            <assignToReference>nbrCountServiceTerritories</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>PC_Business_Type</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Service_Territory_Found_0_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Service_Territories_5</name>
        <label># Service Territories</label>
        <locationX>2208</locationX>
        <locationY>1563</locationY>
        <assignmentItems>
            <assignToReference>nbrCountServiceTerritories</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>PC_Business_Type_Segment</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Service_Territory_Found_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Lookup_Attributes</name>
        <label>Set Lookup Attributes</label>
        <locationX>1154</locationX>
        <locationY>1053</locationY>
        <assignmentItems>
            <assignToReference>txtProfitCenterName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recOpportunity.Profit_Center_Name__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>txtBusinessType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recOpportunity.Business_Type_Attribute__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>txtPropertyType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recOpportunity.Property_Type_Attribute__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Service_Territories</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Only_Service_Territory</name>
        <label>Set Only Service Territory</label>
        <locationX>1197</locationX>
        <locationY>1298</locationY>
        <assignmentItems>
            <assignToReference>recServiceTerritory</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Territories_Single</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Territories_Single</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Only_Service_Territory_2</name>
        <label>Set Only Service Territory</label>
        <locationX>2461</locationX>
        <locationY>1791</locationY>
        <assignmentItems>
            <assignToReference>recServiceTerritory</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Territories_Multi</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Territories_Multi</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Opportunity</name>
        <label>Set Opportunity</label>
        <locationX>1041</locationX>
        <locationY>1053</locationY>
        <assignmentItems>
            <assignToReference>recOpportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Opportunity</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Lookup_Attributes</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_OpportunityId</name>
        <label>Set OpportunityId</label>
        <locationX>806</locationX>
        <locationY>771</locationY>
        <assignmentItems>
            <assignToReference>opportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>To be returned to calling Flow.</description>
        <name>Set_ST</name>
        <label>Set ST</label>
        <locationX>1250</locationX>
        <locationY>1920</locationY>
        <assignmentItems>
            <assignToReference>varServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recServiceTerritory.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_WorkOrder</name>
        <label>Set WorkOrder</label>
        <locationX>1191</locationX>
        <locationY>552</locationY>
        <assignmentItems>
            <assignToReference>recWorkOrder</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Work_Order</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Has_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WorkOrder_OpportunityId</name>
        <label>Set WorkOrder OpportunityId</label>
        <locationX>1068</locationX>
        <locationY>771</locationY>
        <assignmentItems>
            <assignToReference>opportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recWorkOrder.Opportunity__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WorkOrder_Territory</name>
        <label>Set WorkOrder Territory</label>
        <locationX>1444</locationX>
        <locationY>1915</locationY>
        <assignmentItems>
            <assignToReference>recWorkOrder.ServiceTerritoryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recServiceTerritory.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_WorkOrder</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_WorkOrderId</name>
        <label>Set WorkOrderId</label>
        <locationX>937</locationX>
        <locationY>552</locationY>
        <assignmentItems>
            <assignToReference>workOrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Work_Order</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <description>Filter in only those ST records that contain the Profit Center Name + Business Type in the Service Territory name.</description>
        <name>PC_Business_Type</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>PC + Business Type</label>
        <locationX>1579</locationX>
        <locationY>1300</locationY>
        <assignNextValueToReference>currentItem_PC_Business_Type_Segment</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>STcollection</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_PC_Business_Type_Segment.Name</leftValueReference>
            <operator>Contains</operator>
            <rightValue>
                <elementReference>txtBusinessType</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Service_Territories_2</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <description>Filter in only those ST records that contain the Profit Center Name + Business Type + Customer Segment in the Service Territory name.</description>
        <name>PC_Business_Type_Segment</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>PC + Business Type + Segment</label>
        <locationX>1944</locationX>
        <locationY>1563</locationY>
        <assignNextValueToReference>currentItem_PC_Business_Type_Segment</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>PC_Business_Type</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_PC_Business_Type_Segment.Name</leftValueReference>
            <operator>Contains</operator>
            <rightValue>
                <elementReference>fxCustomerSegment</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Service_Territories_3</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Sort_Territories_by_Name</name>
        <elementSubtype>SortCollectionProcessor</elementSubtype>
        <label>Sort Territories by Name</label>
        <locationX>1361</locationX>
        <locationY>1053</locationY>
        <collectionProcessorType>SortCollectionProcessor</collectionProcessorType>
        <collectionReference>Get_Service_Territories</collectionReference>
        <connector>
            <targetReference>Service_Territories</targetReference>
        </connector>
        <sortOptions>
            <doesPutEmptyStringAndNullFirst>false</doesPutEmptyStringAndNullFirst>
            <sortField>Name</sortField>
            <sortOrder>Desc</sortOrder>
        </sortOptions>
    </collectionProcessors>
    <decisions>
        <name>Found_Opportunity</name>
        <label>Found Opportunity?</label>
        <locationX>944</locationX>
        <locationY>918</locationY>
        <defaultConnectorLabel>No Opportunity</defaultConnectorLabel>
        <rules>
            <name>OpportunityFound</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Opportunity</targetReference>
            </connector>
            <label>Opportunity Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_Opportunity</name>
        <label>Has Opportunity?</label>
        <locationX>1185</locationX>
        <locationY>676</locationY>
        <defaultConnectorLabel>No Opportunity</defaultConnectorLabel>
        <rules>
            <name>WorkOrder_Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recWorkOrder.Opportunity__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_WorkOrder_OpportunityId</targetReference>
            </connector>
            <label>WorkOrder Opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <name>Service_Territory_Found</name>
        <label>Service Territory Found?</label>
        <locationX>1476</locationX>
        <locationY>1181</locationY>
        <defaultConnectorLabel>No Service Territory</defaultConnectorLabel>
        <rules>
            <name>One_Service_Territory</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Territories_Single</targetReference>
            </connector>
            <label>One Service Territory</label>
        </rules>
        <rules>
            <name>Several_Service_Territories</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>PC_Business_Type</targetReference>
            </connector>
            <label>Several Service Territories</label>
        </rules>
    </decisions>
    <decisions>
        <name>Service_Territory_Found_0</name>
        <label>Service Territory Found?</label>
        <locationX>2202</locationX>
        <locationY>1686</locationY>
        <defaultConnectorLabel>No Service Territory</defaultConnectorLabel>
        <rules>
            <name>One_Service_Territory_3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Territories_Multi</targetReference>
            </connector>
            <label>One Service Territory</label>
        </rules>
        <rules>
            <name>Several_Service_Territories_3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <label>Several Service Territories</label>
        </rules>
    </decisions>
    <decisions>
        <name>Service_Territory_Found_0_0</name>
        <label>Service Territory Found?</label>
        <locationX>1835</locationX>
        <locationY>1460</locationY>
        <defaultConnectorLabel>No Service Territory</defaultConnectorLabel>
        <rules>
            <name>One_Service_Territory_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_the_correct_collection_to_use</targetReference>
            </connector>
            <label>One Service Territory</label>
        </rules>
        <rules>
            <name>Several_Service_Territories_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>nbrCountServiceTerritories</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>PC_Business_Type_Segment</targetReference>
            </connector>
            <label>Several Service Territories</label>
        </rules>
    </decisions>
    <decisions>
        <name>Skip_Automation</name>
        <label>Skip Automation?</label>
        <locationX>902</locationX>
        <locationY>177</locationY>
        <defaultConnector>
            <targetReference>Get_ObjectType</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.AutomationBypass__c.SkipAutomation__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Object</name>
        <label>Which Object?</label>
        <locationX>799</locationX>
        <locationY>431</locationY>
        <defaultConnectorLabel>Other Object</defaultConnectorLabel>
        <rules>
            <name>Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objectType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Opportunity</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_OpportunityId</targetReference>
            </connector>
            <label>Opportunity</label>
        </rules>
        <rules>
            <name>WorkOrder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objectType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>WorkOrder</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_WorkOrderId</targetReference>
            </connector>
            <label>WorkOrder</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Object_0</name>
        <label>Which Object?</label>
        <locationX>1353</locationX>
        <locationY>1793</locationY>
        <defaultConnectorLabel>Other Object</defaultConnectorLabel>
        <rules>
            <name>Opportunity_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objectType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Opportunity</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_ST</targetReference>
            </connector>
            <label>Opportunity</label>
        </rules>
        <rules>
            <name>WorkOrder_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>objectType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>WorkOrder</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_WorkOrder_Territory</targetReference>
            </connector>
            <label>WorkOrder</label>
        </rules>
    </decisions>
    <description>SubFlow to Match the Opportunity Attributes to a Service Territory

5.2.2024: Added support for giving Opportunity id as input. Allows this to be used also when there is no WOLI.
1.2.2023: Added missing Property Types to fxCustomerSegment formula.
10.1.2023: Fix after Oppo source picklist fields update.
21.12.2022: Fixed a bug in the logic.
5.12.2022: All three levels of the ST selection logic implemented.
2.12.2022: Modified the criteria in first ST collection creation. Multi ST logic is non-working atm?
02.12.2023: Save Active Version as R2</description>
    <environments>Default</environments>
    <formulas>
        <description>Derives the additional part to be used after Profit Center (e.g. Vantaa); Consumers Single House or Consumers or...</description>
        <name>fxCustomerSegment</name>
        <dataType>String</dataType>
        <expression>/* Apartment, Single House, ... are used in the Collection Filter to query the matching ST:s based on partial match */
IF({!txtBusinessType}=&quot;Consumer&quot;,&quot;Consumer&quot; +CASE({!txtPropertyType},&quot;APA&quot;,&quot; Apartment&quot;,&quot;ROW&quot;,&quot; Apartment&quot;,&quot;HRC&quot;,&quot; Apartment&quot;,&quot;HOU&quot;,&quot; Single House&quot;,&quot;COT&quot;,&quot; Single House&quot;, &quot;&quot;),&quot;&quot;)
+IF(OR({!txtBusinessType}=&quot;NB&quot;,{!txtBusinessType}=&quot;RN&quot;),&quot;Project&quot;,&quot;&quot;)

/* IF(txtBusinessType=&quot;Consumer&quot;,&quot;Consumer&quot; +CASE(txtPropertyType,&quot;APA&quot;,&quot; Apartment&quot;,&quot;HOU&quot;,&quot; Single House&quot;, &quot;&quot;),&quot;&quot;)
+IF(OR(txtBusinessType=&quot;NB&quot;,txtBusinessType=&quot;RN&quot;),&quot;Project&quot;,&quot;&quot;) */

/* IF(txtBusinessType=&quot;CON&quot;,&quot;Consumers&quot; +CASE(txtPropertyType,&quot;APT&quot;,&quot; Apartments&quot;,&quot; Single House&quot;),&quot;&quot;)
+IF(OR(txtBusinessType=&quot;NB&quot;,txtBusinessType=&quot;RN&quot;),&quot;Projects&quot;,&quot;&quot;) */</expression>
    </formulas>
    <interviewLabel>Assign Service Territory SubFlow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Assign Service Territory SubFlow R2.3</label>
    <loops>
        <name>Loop_Territories_Multi</name>
        <label>Loop Territories Multi</label>
        <locationX>2304</locationX>
        <locationY>1791</locationY>
        <collectionReference>PC_Business_Type_Segment</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Only_Service_Territory_2</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Which_Object_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Territories_Single</name>
        <label>Loop Territories Single</label>
        <locationX>1361</locationX>
        <locationY>1298</locationY>
        <collectionReference>STcollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_Only_Service_Territory</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Which_Object_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Opportunity</name>
        <label>Get Opportunity</label>
        <locationX>952</locationX>
        <locationY>771</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_Opportunity</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>opportunityId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get all ST records that contain the Profit Center Name somewhere in the Service Territory name. Max. 3 levels.</description>
        <name>Get_Service_Territories</name>
        <label>Get Service Territories</label>
        <locationX>1257</locationX>
        <locationY>1053</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Sort_Territories_by_Name</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3 OR 4)</filterLogic>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Parents_Parent_Name__c</field>
            <operator>Contains</operator>
            <value>
                <elementReference>txtProfitCenterName</elementReference>
            </value>
        </filters>
        <filters>
            <field>Parent_Name__c</field>
            <operator>Contains</operator>
            <value>
                <elementReference>txtProfitCenterName</elementReference>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>Contains</operator>
            <value>
                <elementReference>txtProfitCenterName</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ServiceTerritory</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Work_Order</name>
        <label>Get Work Order</label>
        <locationX>1065</locationX>
        <locationY>552</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_WorkOrder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>workOrderId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_WorkOrder</name>
        <label>Update WorkOrder</label>
        <locationX>1567</locationX>
        <locationY>1915</locationY>
        <inputReference>recWorkOrder</inputReference>
    </recordUpdates>
    <start>
        <locationX>784</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Skip_Automation</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Get_ObjectType</name>
        <label>Get ObjectType</label>
        <locationX>807</locationX>
        <locationY>291</locationY>
        <connector>
            <targetReference>Which_Object</targetReference>
        </connector>
        <flowName>DetermineObjectTypeSubFlow</flowName>
        <inputAssignments>
            <name>recordId</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>objectType</assignToReference>
            <name>sObjectType</name>
        </outputAssignments>
    </subflows>
    <variables>
        <name>currentItem_Filter_Territories_on_Segment</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceTerritory</objectType>
    </variables>
    <variables>
        <name>currentItem_PC_Business_Type_Segment</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceTerritory</objectType>
    </variables>
    <variables>
        <name>nbrCountServiceTerritories</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>objectType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>opportunityId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recServiceTerritory</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceTerritory</objectType>
    </variables>
    <variables>
        <name>recWorkOrder</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrder</objectType>
    </variables>
    <variables>
        <name>STcollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceTerritory</objectType>
    </variables>
    <variables>
        <name>txtBusinessType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>txtCustomerSegment</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>txtProfitCenterName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>txtPropertyType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varServiceTerritoryId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>workOrderId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
